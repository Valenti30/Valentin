<!DOCTYPE html>
<html lang="es">
<head>
<title> eBOARD </title>
<meta charset="UTF-8">
<meta name="viewport" content="widht=device-widht, user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1">
<link href="css/estiloWebUsuario.css" type="text/css" rel="stylesheet">
<link rel="stylesheet" href="css/login.css">
<script src="js/login.js"></script>
<script>
let socket = new WebSocket("ws://127.0.0.1:9990");

socket.onopen = function(e) {
  console.log("[open] Connection established");
  console.log("Sending to server");
  socket.send('{"message":"Entra"}');
  console.log("Conexion abierta");
};


var g_idMensaje = 0;
var id_jugador = 0;
var id_staff = 0;
var g_logeado = false;

function getLogeado(){
return g_logeado;
}


function dameIdMensaje()
{
    g_idMensaje++;
    return g_idMensaje;
}

/*function crearJugador()
{
    id_jugador++;
    var id_mensaje = dameIdMensaje();
    var nombre_jugador = "valen"; //document.getElementById(id).value
    var apellidos_jugador = "gracia sastre";
    var dni_jugador = "43231226N";
    var dorsal_jugador = "13";
    var posicion_jugador = "1";
    var email_jugador = "valentingracia@estudiante.edib.es";

    var mensajeJSON = {action: "crearJugador", id: id_mensaje, idJugador: id_jugador, nombre_jugador: nombre_jugador, apellidos_jugador: apellidos_jugador, dni_jugador: dni_jugador, dorsal_jugador: dorsal_jugador, posicion_jugador: posicion_jugador, email_jugador: email_jugador};
    socket.send(JSON.stringify(mensajeJSON));

}*/

function crearStaff()
{
    id_staff++;
    var id_mensaje = dameIdMensaje();

    var mensajeJSON = {action: "crearStaff", id: id_mensaje, idStaff: id_staff};
    socket.send(JSON.stringify(mensajeJSON));

}

socket.onmessage = function(event) {     //Lo que ejecutamos cuando se recibe un mensaje.
  //console.log(`[message] Data received from server: ${event.data}`);
  var object = JSON.parse(event.data);
  if(object.action == "responseCrearJugador")
  {
    crearJugador(object);
    console.log(object.respuesta);
    console.log(object.datos);
  }
  if(object.action == "responseCrearStaff")
  {
    console.log(object.respuesta);
    console.log(object.datos);
  }
  
  if (object.respuesta == "te has logueado con éxito"){
    g_logeado = true;
  }
  
  if (object.respuesta == "se ha cerrado sesión"){
    g_logeado = false;
  }
  console.log(object);


  //document.getElementById("received_messages").innerHTML += "<div>" + object.message + "</div>";

};

socket.onclose = function(event) {
  if (event.wasClean) {
    console.log(`[close] Connection closed cleanly, code=${event.code} reason=${event.reason}`);
  } else {
    // e.g. server process killed or network down
    // event.code is usually 1006 in this case
    console.log('[close] Connection died');
  }
};

socket.onerror = function(error) {
  alert(`[error] ${error.message}`);
};
</script>
</head>
<body>
<h1>eBOARD </h1>
    <header>
    	<nav class="menuCSS3">
		<ul>
			<li><a href="#">Menú</a>
				<ul>
					<li><a onclick="document.getElementById('id01').style.display='block'">Login</a></li>
					<li><a onclick="document.getElementById('id02').style.display='block'">Registrarse</a></li>
				</ul>
			</li>
			<li><a href="#">Crear</a>
				<ul>
					<li><a onclick="document.getElementById('id03').style.display='block'">Crear jugador</a></li>
					<li><a href="#">Crear personal staff</a></li>
				</ul>
			</li>
			<li><a href="#">Entrenamiento</a>
				<ul>
					<li><a href="#">Marcador</a></li>
				</ul>
			<li><a href="#">Equipos</a>
				<ul>
					<li><a href="#">Contrarios</a></li>
					<li><a href="#">Crear equipo visitante</a></li>
				</ul>
			</li>
		</ul>
	</nav>
   <!-- Button to open the modal login form -->
   
<!--<button onclick="document.getElementById('id01').style.display='block'">Login</button>
<button onclick="document.getElementById('id02').style.display='block'">Registrarse</button>
<button onclick="document.getElementById('id03').style.display='block'">Crear jugador</button>-->
<!-- The Modal -->
<div id="id01" class="modal" style="background-color:green;">
<center><h1> eBOARD </h1></center>
  <span onclick="document.getElementById('id01').style.display='none'"
class="close" title="Close Modal">&times;</span>

  <!-- Modal Content -->
  <div class="modal-content animate" action="/action_page.php">
    <div class="imgcontainer">
      <img src="img/img_avatar2.png" alt="Avatar" class="avatar">
       </div>
          <div  class="container" align="left"> 
            <label class="datos" for="uname"><b>Username</b></label>
            <input id="usuario_login" type="text" placeholder="Usuario" name="uname" required>
            <br>
            <br>
            <br>
            <label for="psw"><b>Password</b></label>
            <input id="contrasenya_login" type="password" placeholder="Contraseña" name="psw" required>
            <br>
            <br>
            <button id="log" onclick="cerrarCapa() , iniciarSesion()">Login</button>
            <button type="button" onclick="document.getElementById('id01').style.display='none'" class="cancelbtn">Cancelar</button>
            <br>
            <label>
                <input type="checkbox" checked="checked" name="remember"> Guardar credenciales
            </label><br><br>
            <span class="psw">Olvidaste tu <a href="#">contraseña?</a></span>
        </div> 
    </div>
</div> 
<div id = "id02" class="modal" style="background-color:green;">
<center>
    <h1>Registro</h1>
    <center><input id = "usuario" type = "text" placeholder="nombre de usuario"></input></center><br><br>
    <input id = "password" type = "password" placeholder="contraseña"></input><br><br>
    <button onclick = cerrarCapa2(),crearUsuario()>Registrar</button>
    <button type="button" onclick="document.getElementById('id02').style.display='none'" class="cancelbtn">Cancelar</button>
</center>
</div>

<div id = "id03" class="modal" style="background-color:green;">
<center>
    <h1>Crear Jugador</h1>
    <input id = "nombre" type = "text" placeholder = "nombre del jugador"> </input> <br><br>
    <input id = "apellidos" type = "text" placeholder = "apellidos del jugador"> </input> <br><br>
    <input id = "dni" type = "text" placeholder = "dni del jugador"> </input> <br><br>
    <input id = "dorsal" type = "text" placeholder = "dorsal del jugador"> </input> <br><br>
    <input id = "posicion" type = "text" placeholder = "posicion del jugador"> </input> <br><br>
    <input id = "email" type = "text" placeholder = "email del jugador"> </input> <br><br>
    <button onclick = cerrarCapa3(),crearJugador()>Crear jugador</button>
    <button type="button" onclick="document.getElementById('id03').style.display='none'" class="cancelbtn">Cancelar</button>
</center>
</form>
</div>
</header>
</body>
</html>




